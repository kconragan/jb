angular.module("app",["ui.router","angular-carousel","templatescache","ngTextTruncate","projects"]).run(function(){FastClick.attach(document.body)}),angular.module("projects",[]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/projects"),t.state("projectList",{url:"/projects",controller:"ProjectsCtrl",templateUrl:"projects/projects.html"}).state("projectDetail",{url:"/projects/:id",controller:"ProjectCtrl",templateUrl:"projects/project.html"})}]),angular.module("app").controller("ProjectsCtrl",["$scope","$http","$filter","dataService",function(t,e,r,o){o.getAlbums().then(function(e){t.projects=e,t.predicate="-modified"})}]).controller("ProjectCtrl",["$scope","$stateParams","dataService",function(t,e,r){console.log(e.id),r.getAlbumPhotos(e.id).then(function(e){t.currentArtwork=6,t.title=e.title,t.description=e.description,t.masthead=e.masthead,t.photos=e.photos}),t.updateLightbox=function(e){t.currentArtwork=e}}]),angular.module("app").directive("lightboxTrigger",["$timeout",function(t){"use strict";return{link:function(e,r,o){r.bind("click",function(){e.$apply(function(){e.currentArtwork=o.currentIndex,$(".lightbox").removeClass("is-hidden")}),t(function(){},200)})}}}]).directive("closeLightbox",[function(){"use strict";return{link:function(t,e){e.bind("click",function(){$(".lightbox").addClass("is-hidden"),t.$apply(function(){t.updateLightbox(0)})})}}}]).directive("ripple",[function(){"use strict";return{link:function(t,e){e.bind("click",function(t){console.log("trigger ripple");var e=$("<div/>"),r=$(this).offset(),o=t.pageX-r.left,i=t.pageY-r.top;e.addClass("ripple-effect");var n=$(".ripple-effect");n.css("height",$(this).height()),n.css("width",$(this).height()),e.css({top:i-n.height()/2,left:o-n.width()/2,background:$(this).data("ripple-color")}).appendTo($(this)),window.setTimeout(function(){e.remove()},2e3)})}}}]);var GOOGLEID="112223276805962705555";angular.module("projects",[]).factory("dataService",["$http","$q",function(t,e){var r="https://picasaweb.google.com/data/feed/api/user/"+GOOGLEID+"/?alt=json";return _createPiasaPhotoUrl=function(t,e){var r=t.split("/"),o=r[0]+"//"+r[2]+"/"+r[3]+"/"+r[4]+"/"+r[5]+"/"+r[6]+"/s1280/"+r[7];return console.log(o),o},{getAlbums:function(){var o=e.defer(),i=[];return t.get(r).success(function(e){var r=e.feed.entry;_.sortBy(r,function(t){var e=new Date(t.updated.$t);return console.log(e.getTime()),e.getTime()}).reverse(),_.each(r,function(e){var r={};r.id=e.gphoto$id.$t,r.title=e.title.$t,r.modified=e.updated.$t,r.thumbUrl=e.link[0].href,"Profile Photos"!==r.title&&t.get(r.thumbUrl).success(function(t){r.thumb=_createPiasaPhotoUrl(t.feed.entry[0].content.src),console.log("thumb url is ",r.thumb),i.push(r)}).error(function(t){console.log(t)})}),o.resolve(i)}).error(function(){o.reject}),o.promise},getAlbumThumb:function(){},getAlbumPhotos:function(r){var o={},i="https://picasaweb.google.com/data/feed/api/user/"+GOOGLEID+"/albumid/"+r+"?alt=json&?imgmax=912",n=e.defer();return t.get(i).success(function(t){console.log(t),o.title=t.feed.title.$t,o.masthead=_createPiasaPhotoUrl(t.feed.entry[0].content.src);for(var e=[],r=0;r<t.feed.entry.length;r++){var i=t.feed.entry[r];""!==i.summary.$t&&""!==o.description&&(o.description=i.summary.$t);var c=i.content.src.split("/"),s=c[0]+"//"+c[2]+"/"+c[3]+"/"+c[4]+"/"+c[5]+"/"+c[6]+"/w1200-h1200-c/"+c[7],l=c[0]+"//"+c[2]+"/"+c[3]+"/"+c[4]+"/"+c[5]+"/"+c[6]+"/s1640/"+c[7];i.url=s,i.bigUrl=l,e.push(i)}o.photos=e,n.resolve(o)}).error(function(){n.reject}),n.promise}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInByb2plY3RzL21vZHVsZS5qcyIsInJvdXRlcy5qcyIsInByb2plY3RzL3Byb2plY3RzLmNvbnRyb2xsZXIuanMiLCJwcm9qZWN0cy9wcm9qZWN0cy5kaXJlY3RpdmVzLmpzIiwicHJvamVjdHMvcHJvamVjdHMuc2VydmljZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFBLE9BQUEsT0FDQSxZQUVBLG1CQUNBLGlCQUNBLGlCQUNBLGFBRUEsSUFBQSxXQUNBLFVBQUEsT0FBQSxTQUFBLFFDVEEsUUFBQSxPQUFBLGVDQUEsUUFBQSxPQUFBLE9BQ0EsUUFBQSxpQkFBQSxxQkFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFVBQUEsYUFDQSxFQUNBLE1BQUEsZUFDQSxJQUFBLFlBQ0EsV0FBQSxlQUNBLFlBQUEsMkJBRUEsTUFBQSxpQkFDQSxJQUFBLGdCQUNBLFdBQUEsY0FDQSxZQUFBLDZCQ1hBLFFBQUEsT0FBQSxPQUNBLFdBQUEsZ0JBQUEsU0FBQSxRQUFBLFVBQUEsY0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxZQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsU0FBQSxFQUNBLEVBQUEsVUFBQSxpQkFHQSxXQUFBLGVBQUEsU0FBQSxlQUFBLGNBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxRQUFBLElBQUEsRUFBQSxJQUVBLEVBQUEsZUFBQSxFQUFBLElBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQ0EsRUFBQSxNQUFBLEVBQUEsTUFDQSxFQUFBLFlBQUEsRUFBQSxZQUNBLEVBQUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxPQUFBLEVBQUEsU0FHQSxFQUFBLGVBQUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxNQ3BCQSxRQUFBLE9BQUEsT0FDQSxVQUFBLG1CQUFBLFdBQUEsU0FBQSxHQUNBLFlBQ0EsUUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFFBQUEsV0FDQSxFQUFBLE9BQUEsV0FFQSxFQUFBLGVBQUEsRUFBQSxhQUNBLEVBQUEsYUFBQSxZQUFBLGVBRUEsRUFBQSxhQUNBLFlBS0EsVUFBQSxpQkFBQSxXQUNBLFlBQ0EsUUFDQSxLQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxRQUFBLFdBQ0EsRUFBQSxhQUFBLFNBQUEsYUFDQSxFQUFBLE9BQUEsV0FDQSxFQUFBLGVBQUEsWUFNQSxVQUFBLFVBQUEsV0FDQSxZQUNBLFFBQ0EsS0FBQSxTQUFBLEVBQUEsR0FFQSxFQUFBLEtBQUEsUUFBQSxTQUFBLEdBRUEsUUFBQSxJQUFBLGlCQUVBLElBQUEsR0FBQSxFQUFBLFVBQ0EsRUFBQSxFQUFBLE1BQUEsU0FDQSxFQUFBLEVBQUEsTUFBQSxFQUFBLEtBQ0EsRUFBQSxFQUFBLE1BQUEsRUFBQSxHQUdBLEdBQUEsU0FBQSxnQkFDQSxJQUFBLEdBQUEsRUFBQSxpQkFFQSxHQUFBLElBQUEsU0FBQSxFQUFBLE1BQUEsVUFDQSxFQUFBLElBQUEsUUFBQSxFQUFBLE1BQUEsVUFDQSxFQUFBLEtBQ0EsSUFBQSxFQUFBLEVBQUEsU0FBQSxFQUNBLEtBQUEsRUFBQSxFQUFBLFFBQUEsRUFDQSxXQUFBLEVBQUEsTUFBQSxLQUFBLGtCQUVBLFNBQUEsRUFBQSxPQUVBLE9BQUEsV0FBQSxXQUNBLEVBQUEsVUFDQSxXQ3pEQSxJQUFBLFVBQUEsdUJBRUEsU0FBQSxPQUFBLGVBQ0EsUUFBQSxlQUFBLFFBQUEsS0FBQSxTQUFBLEVBQUEsR0FFQSxHQUFBLEdBQUEsbURBQUEsU0FBQSxZQVVBLE9BUkEsc0JBQUEsU0FBQSxFQUFBLEdBQ0EsR0FDQSxHQUFBLEVBQUEsTUFBQSxLQUNBLEVBQUEsRUFBQSxHQUFBLEtBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLFVBQUEsRUFBQSxFQUVBLE9BREEsU0FBQSxJQUFBLEdBQ0EsSUFTQSxVQUFBLFdBR0EsR0FBQSxHQUFBLEVBQUEsUUFDQSxJQThDQSxPQTNDQSxHQUFBLElBQUEsR0FBQSxRQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxLQUFBLEtBS0EsR0FBQSxPQUFBLEVBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxHQUFBLE1BQUEsRUFBQSxRQUFBLEdBRUEsT0FEQSxTQUFBLElBQUEsRUFBQSxXQUNBLEVBQUEsWUFDQSxVQUdBLEVBQUEsS0FBQSxFQUFBLFNBQUEsR0FFQSxHQUFBLEtBRUEsR0FBQSxHQUFBLEVBQUEsVUFBQSxHQUNBLEVBQUEsTUFBQSxFQUFBLE1BQUEsR0FDQSxFQUFBLFNBQUEsRUFBQSxRQUFBLEdBQ0EsRUFBQSxTQUFBLEVBQUEsS0FBQSxHQUFBLEtBR0EsbUJBQUEsRUFBQSxPQUtBLEVBQUEsSUFBQSxFQUFBLFVBQUEsUUFBQSxTQUFBLEdBRUEsRUFBQSxNQUFBLHFCQUFBLEVBQUEsS0FBQSxNQUFBLEdBQUEsUUFBQSxLQUNBLFFBQUEsSUFBQSxnQkFBQSxFQUFBLE9BQ0EsRUFBQSxLQUFBLEtBRUEsTUFBQSxTQUFBLEdBQ0EsUUFBQSxJQUFBLE9BR0EsRUFBQSxRQUFBLEtBRUEsTUFBQSxXQUNBLEVBQUEsU0FFQSxFQUFBLFNBR0EsY0FBQSxhQUdBLGVBQUEsU0FBQSxHQUVBLEdBQUEsTUFFQSxFQUFBLG1EQUFBLFNBQUEsWUFBQSxFQUFBLHdCQUNBLEVBQUEsRUFBQSxPQW9DQSxPQW5DQSxHQUFBLElBQUEsR0FBQSxRQUFBLFNBQUEsR0FDQSxRQUFBLElBQUEsR0FDQSxFQUFBLE1BQUEsRUFBQSxLQUFBLE1BQUEsR0FDQSxFQUFBLFNBQUEscUJBQUEsRUFBQSxLQUFBLE1BQUEsR0FBQSxRQUFBLElBRUEsS0FBQSxHQURBLE1BQ0EsRUFBQSxFQUFBLEVBQUEsRUFBQSxLQUFBLE1BQUEsT0FBQSxJQUFBLENBRUEsR0FBQSxHQUFBLEVBQUEsS0FBQSxNQUFBLEVBTUEsTUFBQSxFQUFBLFFBQUEsSUFBQSxLQUFBLEVBQUEsY0FDQSxFQUFBLFlBQUEsRUFBQSxRQUFBLEdBR0EsSUFBQSxHQUFBLEVBQUEsUUFBQSxJQUFBLE1BQUEsS0FFQSxFQUFBLEVBQUEsR0FBQSxLQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxrQkFBQSxFQUFBLEdBQ0EsRUFBQSxFQUFBLEdBQUEsS0FBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsVUFBQSxFQUFBLEVBQ0EsR0FBQSxJQUFBLEVBQ0EsRUFBQSxPQUFBLEVBRUEsRUFBQSxLQUFBLEdBR0EsRUFBQSxPQUFBLEVBRUEsRUFBQSxRQUFBLEtBR0EsTUFBQSxXQUNBLEVBQUEsU0FFQSxFQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICd1aS5yb3V0ZXInLFxuICAvLyAnbmdBbmltYXRlJyxcbiAgJ2FuZ3VsYXItY2Fyb3VzZWwnLFxuICAndGVtcGxhdGVzY2FjaGUnLFxuICAnbmdUZXh0VHJ1bmNhdGUnLFxuICAncHJvamVjdHMnXG5dKVxuLnJ1bihmdW5jdGlvbigpIHtcbiAgRmFzdENsaWNrLmF0dGFjaChkb2N1bWVudC5ib2R5KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3Byb2plY3RzJywgW10pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvcHJvamVjdHMnKTtcbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ3Byb2plY3RMaXN0Jywge1xuICAgICAgdXJsICAgICAgICAgOiAnL3Byb2plY3RzJyxcbiAgICAgIGNvbnRyb2xsZXIgIDogJ1Byb2plY3RzQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybCA6ICdwcm9qZWN0cy9wcm9qZWN0cy5odG1sJ1xuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0RGV0YWlsJywge1xuICAgICAgdXJsICAgICAgICAgOiAnL3Byb2plY3RzLzppZCcsXG4gICAgICBjb250cm9sbGVyICA6ICdQcm9qZWN0Q3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybCA6ICdwcm9qZWN0cy9wcm9qZWN0Lmh0bWwnXG4gICAgfSlcbn0pXG4iLCIndXNlIHN0cmljdCdcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuY29udHJvbGxlcignUHJvamVjdHNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRmaWx0ZXIsIGRhdGFTZXJ2aWNlKSB7XG4gICAgZGF0YVNlcnZpY2UuZ2V0QWxidW1zKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgJHNjb3BlLnByb2plY3RzICAgICAgID0gZGF0YTtcbiAgICAgICRzY29wZS5wcmVkaWNhdGUgICAgICA9ICctbW9kaWZpZWQnO1xuICAgIH0pO1xuICB9KVxuICAuY29udHJvbGxlcignUHJvamVjdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZVBhcmFtcywgZGF0YVNlcnZpY2UpIHtcbiAgICBjb25zb2xlLmxvZygkc3RhdGVQYXJhbXMuaWQpO1xuXG4gICAgZGF0YVNlcnZpY2UuZ2V0QWxidW1QaG90b3MoJHN0YXRlUGFyYW1zLmlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICRzY29wZS5jdXJyZW50QXJ0d29yayA9IDY7XG4gICAgICAkc2NvcGUudGl0bGUgICAgICAgICAgPSBkYXRhLnRpdGxlO1xuICAgICAgJHNjb3BlLmRlc2NyaXB0aW9uICAgID0gZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgICRzY29wZS5tYXN0aGVhZCAgICAgICA9IGRhdGEubWFzdGhlYWQ7XG4gICAgICAkc2NvcGUucGhvdG9zICAgICAgICAgPSBkYXRhLnBob3RvcztcbiAgICB9KTtcbiAgICBcbiAgICAkc2NvcGUudXBkYXRlTGlnaHRib3ggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgJHNjb3BlLmN1cnJlbnRBcnR3b3JrID0gaW5kZXg7XG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuZGlyZWN0aXZlKCdsaWdodGJveFRyaWdnZXInLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24gKCR0aW1lb3V0KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHJldHVybiB7XG4gICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHNjb3BlLnVwZGF0ZUxpZ2h0Ym94KGF0dHJzLmN1cnJlbnRJbmRleCk7XG4gICAgICAgICAgICBzY29wZS5jdXJyZW50QXJ0d29yayA9IGF0dHJzLmN1cnJlbnRJbmRleDtcbiAgICAgICAgICAgICQoJy5saWdodGJveCcpLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfV0pXG4gIC5kaXJlY3RpdmUoJ2Nsb3NlTGlnaHRib3gnLCBbZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICByZXR1cm4ge1xuICAgICAgbGluayA6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJCgnLmxpZ2h0Ym94JykuYWRkQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzY29wZS51cGRhdGVMaWdodGJveCgwKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XSlcbiAgLmRpcmVjdGl2ZSgncmlwcGxlJywgW2Z1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxpbmsgOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgXG4gICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZygndHJpZ2dlciByaXBwbGUnKTtcbiAgICAgICAgICBcbiAgICAgICAgICB2YXIgJGRpdiAgICAgID0gJCgnPGRpdi8+JyksXG4gICAgICAgICAgICAgIGJ0bk9mZnNldCA9ICQodGhpcykub2Zmc2V0KCksXG4gICAgICAgICAgICAgIHhQb3MgICAgICA9IGV2ZW50LnBhZ2VYIC0gYnRuT2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgIHlQb3MgICAgICA9IGV2ZW50LnBhZ2VZIC0gYnRuT2Zmc2V0LnRvcDtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgXG4gICAgICAgICAgICAkZGl2LmFkZENsYXNzKCdyaXBwbGUtZWZmZWN0Jyk7XG4gICAgICAgICAgICB2YXIgJHJpcHBsZSA9ICQoXCIucmlwcGxlLWVmZmVjdFwiKTtcbiAgICAgICAgICBcbiAgICAgICAgICAgICRyaXBwbGUuY3NzKFwiaGVpZ2h0XCIsICQodGhpcykuaGVpZ2h0KCkpO1xuICAgICAgICAgICAgJHJpcHBsZS5jc3MoXCJ3aWR0aFwiLCAkKHRoaXMpLmhlaWdodCgpKTtcbiAgICAgICAgICAgICRkaXYuY3NzKHtcbiAgICAgICAgICAgICAgdG9wOiB5UG9zIC0gKCRyaXBwbGUuaGVpZ2h0KCkvMiksXG4gICAgICAgICAgICAgIGxlZnQ6IHhQb3MgLSAoJHJpcHBsZS53aWR0aCgpLzIpLFxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAkKHRoaXMpLmRhdGEoXCJyaXBwbGUtY29sb3JcIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXBwZW5kVG8oJCh0aGlzKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAkZGl2LnJlbW92ZSgpO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1dKTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIEdPT0dMRUlEID0gJzExMjIyMzI3NjgwNTk2MjcwNTU1NSc7XG5cbmFuZ3VsYXIubW9kdWxlKCdwcm9qZWN0cycsIFtdKVxuICAuZmFjdG9yeSgnZGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHEpIHtcblxuICAgIHZhciBhbGJ1bXNVUkwgPSAnaHR0cHM6Ly9waWNhc2F3ZWIuZ29vZ2xlLmNvbS9kYXRhL2ZlZWQvYXBpL3VzZXIvJyArIEdPT0dMRUlEICsgJy8/YWx0PWpzb24nO1xuICAgIFxuICAgIF9jcmVhdGVQaWFzYVBob3RvVXJsPSBmdW5jdGlvbihpZCwgc2l6ZSkge1xuICAgICAgdmFyIHNpemUgPSBzaXplIHx8ICdzMTI4MCc7XG4gICAgICB2YXIgdGVtcFVybCA9IGlkLnNwbGl0KCcvJyk7XG4gICAgICB2YXIgdXJsID0gdGVtcFVybFswXSArICcvLycgKyB0ZW1wVXJsWzJdICsgJy8nICsgdGVtcFVybFszXSArICcvJyArIHRlbXBVcmxbNF0gKyAnLycgKyB0ZW1wVXJsWzVdICsgJy8nICsgdGVtcFVybFs2XSArICcvczEyODAvJyArIHRlbXBVcmxbN107XG4gICAgICBjb25zb2xlLmxvZyh1cmwpO1xuICAgICAgcmV0dXJuIHVybFxuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgIC8qXG4gICAgICAgKiBnZXRBbGJ1bXMgZmV0Y2hlcyBhbGwgYWxidW1zIGZyb20gUGljYXNhd2ViIGZvciBhIGdpdmVuXG4gICAgICAgKiB1c2VyIGlkIGFuZCByZXR1cm5zIGFzIGEgbGlzdFxuICAgICAgICovXG4gICAgICBnZXRBbGJ1bXMgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBwcm9taXNlXG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIHZhciBhbGJ1bXMgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNlbmQgaW5pdGlhbCByZXF1ZXN0XG4gICAgICAgICRodHRwLmdldChhbGJ1bXNVUkwpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHZhciBwcm9qZWN0cyA9IGRhdGEuZmVlZC5lbnRyeTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDdXJyZW50bHkgc29ydGluZyBwcm9qZWN0cyBieSBsYXN0IHVwZGF0ZWRcbiAgICAgICAgICAvLyBUaGlzIGlzIGEgaGFjayB1bnRpbCB3ZSBjYW4gZmlndXJlIG91dCBhIG1vcmVcbiAgICAgICAgICAvLyBkZXRlcm1pbmlzdGljIHdheSB0byBlc3RhYmxpc2ggc29ydGluZ1xuICAgICAgICAgIF8uc29ydEJ5KHByb2plY3RzLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKG9iai51cGRhdGVkLiR0KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGQuZ2V0VGltZSgpKTtcbiAgICAgICAgICAgIHJldHVybiBkLmdldFRpbWUoKTtcbiAgICAgICAgICB9KS5yZXZlcnNlKCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gT3JnYW5pemUgZWFjaCBwcm9qZWN0XG4gICAgICAgICAgXy5lYWNoKHByb2plY3RzLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBhbGJ1bSA9IHt9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhbGJ1bS5pZCAgICAgICA9IGRhdGEuZ3Bob3RvJGlkLiR0O1xuICAgICAgICAgICAgYWxidW0udGl0bGUgICAgPSBkYXRhLnRpdGxlLiR0O1xuICAgICAgICAgICAgYWxidW0ubW9kaWZpZWQgPSBkYXRhLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICBhbGJ1bS50aHVtYlVybCA9IGRhdGEubGlua1swXS5ocmVmO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEb24ndCBwcm9jZXNzIFByb2ZpbGUgUGhvdG9zIGFsYnVtLCB3aGljaCBpcyBhbHdheXMgcHVibGljXG4gICAgICAgICAgICBpZihhbGJ1bS50aXRsZSA9PT0gJ1Byb2ZpbGUgUGhvdG9zJykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEZldGNoIGNvdmVyIGltYWdlIGZvciB0aGUgYWxidW1cbiAgICAgICAgICAgICRodHRwLmdldChhbGJ1bS50aHVtYlVybCkuc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAvLyBhbGJ1bS50aHVtYiA9IHJlc3BvbnNlLmZlZWQuZW50cnlbMF0uY29udGVudC5zcmM7XG4gICAgICAgICAgICAgIGFsYnVtLnRodW1iID0gX2NyZWF0ZVBpYXNhUGhvdG9VcmwocmVzcG9uc2UuZmVlZC5lbnRyeVswXS5jb250ZW50LnNyYyk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aHVtYiB1cmwgaXMgJywgYWxidW0udGh1bWIpO1xuICAgICAgICAgICAgICBhbGJ1bXMucHVzaChhbGJ1bSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGFsYnVtcyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3Q7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIH0sXG4gICAgICBcbiAgICAgIGdldEFsYnVtVGh1bWIgOiBmdW5jdGlvbihpZCkge1xuICAgICAgfSxcblxuICAgICAgZ2V0QWxidW1QaG90b3MgOiBmdW5jdGlvbihpZCkge1xuXG4gICAgICAgIHZhciBwcm9qZWN0ID0ge307XG5cbiAgICAgICAgdmFyIGFsYnVtVVJMID0gJ2h0dHBzOi8vcGljYXNhd2ViLmdvb2dsZS5jb20vZGF0YS9mZWVkL2FwaS91c2VyLycgKyBHT09HTEVJRCArICcvYWxidW1pZC8nICsgaWQgKyAnP2FsdD1qc29uJj9pbWdtYXg9OTEyJztcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgJGh0dHAuZ2V0KGFsYnVtVVJMKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICBwcm9qZWN0LnRpdGxlID0gZGF0YS5mZWVkLnRpdGxlLiR0O1xuICAgICAgICAgIHByb2plY3QubWFzdGhlYWQgPSBfY3JlYXRlUGlhc2FQaG90b1VybChkYXRhLmZlZWQuZW50cnlbMF0uY29udGVudC5zcmMpO1xuICAgICAgICAgIHZhciBwaG90b3MgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuZmVlZC5lbnRyeS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgaXRlbSA9IGRhdGEuZmVlZC5lbnRyeVtpXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2VlIGlmIGFuIGltYWdlIGhhcyBhIGNhcHRpb24uIElmIHNvLCB1c2UgYXMgYWxidW0gZGVjc2NyaXB0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBzdXBlciBoYWNreS4gSSBuZWVkIHRvIGZpbmQgYSB3YXkgdG8gYWxsb3cgYWxidW0tbGV2ZWxcbiAgICAgICAgICAgIC8vIGRlc2NyaXB0aW9ucyBidXQgaXQgZG9lc24ndCBjb21lIGJhY2sgaW4gdGhlIHBpY2Fzd2ViIGFwaS5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGl0ZW0uc3VtbWFyeS4kdCAhPT0gJycgJiYgcHJvamVjdC5kZXNjcmlwdGlvbiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgcHJvamVjdC5kZXNjcmlwdGlvbiA9IGl0ZW0uc3VtbWFyeS4kdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHRlbXBVcmwgPSBpdGVtLmNvbnRlbnQuc3JjLnNwbGl0KCcvJyk7XG5cbiAgICAgICAgICAgIHZhciB1cmwgPSB0ZW1wVXJsWzBdICsgJy8vJyArIHRlbXBVcmxbMl0gKyAnLycgKyB0ZW1wVXJsWzNdICsgJy8nICsgdGVtcFVybFs0XSArICcvJyArIHRlbXBVcmxbNV0gKyAnLycgKyB0ZW1wVXJsWzZdICsgJy93MTIwMC1oMTIwMC1jLycgKyB0ZW1wVXJsWzddO1xuICAgICAgICAgICAgdmFyIGJpZ1VybCA9IHRlbXBVcmxbMF0gKyAnLy8nICsgdGVtcFVybFsyXSArICcvJyArIHRlbXBVcmxbM10gKyAnLycgKyB0ZW1wVXJsWzRdICsgJy8nICsgdGVtcFVybFs1XSArICcvJyArIHRlbXBVcmxbNl0gKyAnL3MxNjQwLycgKyB0ZW1wVXJsWzddO1xuICAgICAgICAgICAgaXRlbS51cmwgPSB1cmw7XG4gICAgICAgICAgICBpdGVtLmJpZ1VybCA9IGJpZ1VybDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcGhvdG9zLnB1c2goaXRlbSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcHJvamVjdC5waG90b3MgPSBwaG90b3M7XG5cbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHByb2plY3QpO1xuICAgICAgICAgIC8vIHJldHVybiByZXN1bHQuZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9