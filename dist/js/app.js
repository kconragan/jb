angular.module("app",["ui.router","ngAnimate","angular-carousel","templatescache","ngTextTruncate","projects"]).run(function(){FastClick.attach(document.body)}),angular.module("projects",[]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/projects"),t.state("projectList",{url:"/projects",controller:"ProjectsCtrl",templateUrl:"projects/projects.html"}).state("projectDetail",{url:"/projects/:id",controller:"ProjectCtrl",templateUrl:"projects/project.html"})}]),angular.module("app").controller("ViewController",["$scope",function(t){t.layoutConfig={fullBleed:"fullbleed"}}]).controller("ProjectsCtrl",["$scope","$http","$filter","dataService",function(t,e,o,r){t.layoutConfig.fullbleed="fullbleed",r.getAlbums().then(function(e){t.projects=e,t.predicate="-modified"})}]).controller("ProjectCtrl",["$scope","$stateParams","dataService",function(t,e,o){t.layoutConfig.fullbleed="",t.$on("$stateChangeSuccess",function(){}),o.getAlbumPhotos(e.id).then(function(e){t.currentArtwork=6,t.title=e.title,t.description=e.description,t.masthead=e.masthead,t.photos=e.photos,t.count=e.photos.length}),t.updateLightbox=function(e){console.log(typeof e),t.currentArtwork=parseInt(e)}}]),angular.module("app").directive("lightboxTrigger",["$timeout",function(t){"use strict";return{link:function(e,o,r){o.bind("click",function(){e.$apply(function(){e.currentArtwork!==r.currentIndex&&e.updateLightbox(r.currentIndex),$(".lightbox").removeClass("is-hidden")}),t(function(){},200)})}}}]).directive("contactToggle",function(){"use strict";return{link:function(t,e){e.bind("click",function(){$("#app").addClass("is-hidden"),$("#contact").addClass("is-visible")})}}}).directive("closeAbout",function(){"use strict";return{link:function(t,e){e.bind("click",function(){$("#app").removeClass("is-hidden"),$("#contact").removeClass("is-visible")})}}}).directive("masthead",["$timeout",function(t){"use strict";return{scope:{bar:"=url"},link:function(e,o){$(window).height()+"px";e.$watch("bar",function(e){void 0!==e&&$("<img/>").attr("src",e).load(function(){$(this).remove(),o.addClass("is-loaded"),$(".project-abstract").addClass("is-loaded"),t(function(){$(".masthead .more").addClass("bounce-slowly")},3500)})})}}}]).directive("closeLightbox",[function(){"use strict";return{link:function(t,e){e.bind("click",function(){$(".lightbox").addClass("is-hidden"),t.$apply(function(){t.updateLightbox(0)})})}}}]).directive("ripple",[function(){"use strict";return{link:function(t,e){e.bind("click",function(t){console.log("trigger ripple");var e=$("<div/>"),o=$(this).offset(),r=t.pageX-o.left,n=t.pageY-o.top;e.addClass("ripple-effect");var i=$(".ripple-effect");i.css("height",$(this).height()),i.css("width",$(this).height()),e.css({top:n-i.height()/2,left:r-i.width()/2,background:$(this).data("ripple-color")}).appendTo($(this)),window.setTimeout(function(){e.remove()},2e3)})}}}]).directive("scroll",["$window",function(t){function e(){return window.pageYOffset||document.documentElement.scrollTop}return function(){var o=0,r=0,n=$("header.header");angular.element(t).bind("scroll",function(){var t=$(this).scrollTop();t>o?t>0&&(n.hasClass("is-hidden")||r>0&&(n.addClass("is-hidden"),n.removeClass("is-filled"),r=0)):(console.log("scrolling up"),r++,r>2&&(n.removeClass("is-hidden"),n.hasClass("transparent")&&(t>$(window).height()?n.addClass("is-filled"):n.removeClass("is-filled")))),o=e()})}}]);var GOOGLEID="112223276805962705555";angular.module("projects",[]).factory("dataService",["$http","$q",function(t,e){var o="https://picasaweb.google.com/data/feed/api/user/"+GOOGLEID+"/?alt=json";return _createPiasaPhotoUrl=function(t,e){var o=t.split("/"),r=o[0]+"//"+o[2]+"/"+o[3]+"/"+o[4]+"/"+o[5]+"/"+o[6]+"/s1280/"+o[7];return r},{getAlbums:function(){var r=e.defer(),n=[];return t.get(o).success(function(e){var o=e.feed.entry;_.sortBy(o,function(t){var e=new Date(t.updated.$t);return e.getTime()}).reverse(),_.each(o,function(e){console.log(e);var o={};o.id=e.gphoto$id.$t,o.title=e.title.$t,o.modified=e.updated.$t,o.thumbUrl=e.link[0].href,"Profile Photos"!==o.title&&t.get(o.thumbUrl).success(function(t){o.thumb=_createPiasaPhotoUrl(t.feed.entry[0].content.src),n.push(o)}).error(function(t){console.log(t)})}),r.resolve(n)}).error(function(){r.reject}),r.promise},getAlbumThumb:function(){},getAlbumPhotos:function(r){var n={},i="https://picasaweb.google.com/data/feed/api/user/"+GOOGLEID+"/albumid/"+r+"?alt=json&?imgmax=912",c=e.defer();return t.get(i).success(function(e){t.get(o).success(function(t){var o=t.feed.entry;_.each(o,function(t){t.gphoto$id.$t===r&&(n.description=t.summary.$t,console.log(n.description))}),n.title=e.feed.title.$t,n.masthead=_createPiasaPhotoUrl(e.feed.entry[0].content.src);for(var i=[],s=0;s<e.feed.entry.length;s++){var l=e.feed.entry[s],a=l.content.src.split("/"),u=a[0]+"//"+a[2]+"/"+a[3]+"/"+a[4]+"/"+a[5]+"/"+a[6]+"/w1200-h1200-c/"+a[7],d=a[0]+"//"+a[2]+"/"+a[3]+"/"+a[4]+"/"+a[5]+"/"+a[6]+"/s1640/"+a[7];l.url=u,l.bigUrl=d,i.push(l)}n.photos=i,c.resolve(n)})}).error(function(){c.reject}),c.promise}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsInByb2plY3RzL21vZHVsZS5qcyIsInJvdXRlcy5qcyIsInByb2plY3RzL3Byb2plY3RzLmNvbnRyb2xsZXIuanMiLCJwcm9qZWN0cy9wcm9qZWN0cy5kaXJlY3RpdmVzLmpzIiwicHJvamVjdHMvcHJvamVjdHMuc2VydmljZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFBLE9BQUEsT0FDQSxZQUNBLFlBQ0EsbUJBQ0EsaUJBQ0EsaUJBQ0EsYUFFQSxJQUFBLFdBQ0EsVUFBQSxPQUFBLFNBQUEsUUNUQSxRQUFBLE9BQUEsZUNBQSxRQUFBLE9BQUEsT0FDQSxRQUFBLGlCQUFBLHFCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsVUFBQSxhQUNBLEVBQ0EsTUFBQSxlQUNBLElBQUEsWUFDQSxXQUFBLGVBQ0EsWUFBQSwyQkFFQSxNQUFBLGlCQUNBLElBQUEsZ0JBQ0EsV0FBQSxjQUNBLFlBQUEsNkJDWEEsUUFBQSxPQUFBLE9BQ0EsV0FBQSxrQkFBQSxTQUFBLFNBQUEsR0FDQSxFQUFBLGNBQ0EsVUFBQSxnQkFHQSxXQUFBLGdCQUFBLFNBQUEsUUFBQSxVQUFBLGNBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsYUFBQSxVQUFBLFlBQ0EsRUFBQSxZQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsU0FBQSxFQUNBLEVBQUEsVUFBQSxpQkFHQSxXQUFBLGVBQUEsU0FBQSxlQUFBLGNBQUEsU0FBQSxFQUFBLEVBQUEsR0FHQSxFQUFBLGFBQUEsVUFBQSxHQUVBLEVBQUEsSUFBQSxzQkFBQSxjQUlBLEVBQUEsZUFBQSxFQUFBLElBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQ0EsRUFBQSxNQUFBLEVBQUEsTUFDQSxFQUFBLFlBQUEsRUFBQSxZQUNBLEVBQUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxPQUFBLEVBQUEsT0FDQSxFQUFBLE1BQUEsRUFBQSxPQUFBLFNBR0EsRUFBQSxlQUFBLFNBQUEsR0FDQSxRQUFBLFVBQUEsSUFDQSxFQUFBLGVBQUEsU0FBQSxPQ2xDQSxRQUFBLE9BQUEsT0FDQSxVQUFBLG1CQUFBLFdBQUEsU0FBQSxHQUNBLFlBQ0EsUUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFFBQUEsV0FDQSxFQUFBLE9BQUEsV0FDQSxFQUFBLGlCQUFBLEVBQUEsY0FDQSxFQUFBLGVBQUEsRUFBQSxjQUdBLEVBQUEsYUFBQSxZQUFBLGVBRUEsRUFBQSxhQUNBLFlBS0EsVUFBQSxnQkFBQSxXQUNBLFlBQ0EsUUFDQSxLQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxRQUFBLFdBQ0EsRUFBQSxRQUFBLFNBQUEsYUFDQSxFQUFBLFlBQUEsU0FBQSxvQkFLQSxVQUFBLGFBQUEsV0FDQSxZQUNBLFFBQ0EsS0FBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLEtBQUEsUUFBQSxXQUNBLEVBQUEsUUFBQSxZQUFBLGFBQ0EsRUFBQSxZQUFBLFlBQUEsb0JBS0EsVUFBQSxZQUFBLFdBQUEsU0FBQSxHQUNBLFlBQ0EsUUFDQSxPQUNBLElBQUEsUUFFQSxLQUFBLFNBQUEsRUFBQSxHQU1BLEVBQUEsUUFBQSxTQUFBLElBRUEsR0FBQSxPQUFBLE1BQUEsU0FBQSxHQUNBLFNBQUEsR0FDQSxFQUFBLFVBQUEsS0FBQSxNQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxTQUtBLEVBQUEsU0FBQSxhQUVBLEVBQUEscUJBQUEsU0FBQSxhQUNBLEVBQUEsV0FDQSxFQUFBLG1CQUFBLFNBQUEsa0JBQ0EsZUFRQSxVQUFBLGlCQUFBLFdBQ0EsWUFDQSxRQUNBLEtBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFFBQUEsV0FDQSxFQUFBLGFBQUEsU0FBQSxhQUNBLEVBQUEsT0FBQSxXQUNBLEVBQUEsZUFBQSxZQU1BLFVBQUEsVUFBQSxXQUNBLFlBQ0EsUUFDQSxLQUFBLFNBQUEsRUFBQSxHQUVBLEVBQUEsS0FBQSxRQUFBLFNBQUEsR0FFQSxRQUFBLElBQUEsaUJBRUEsSUFBQSxHQUFBLEVBQUEsVUFDQSxFQUFBLEVBQUEsTUFBQSxTQUNBLEVBQUEsRUFBQSxNQUFBLEVBQUEsS0FDQSxFQUFBLEVBQUEsTUFBQSxFQUFBLEdBR0EsR0FBQSxTQUFBLGdCQUNBLElBQUEsR0FBQSxFQUFBLGlCQUVBLEdBQUEsSUFBQSxTQUFBLEVBQUEsTUFBQSxVQUNBLEVBQUEsSUFBQSxRQUFBLEVBQUEsTUFBQSxVQUNBLEVBQUEsS0FDQSxJQUFBLEVBQUEsRUFBQSxTQUFBLEVBQ0EsS0FBQSxFQUFBLEVBQUEsUUFBQSxFQUNBLFdBQUEsRUFBQSxNQUFBLEtBQUEsa0JBRUEsU0FBQSxFQUFBLE9BRUEsT0FBQSxXQUFBLFdBQ0EsRUFBQSxVQUNBLFlBT0EsVUFBQSxVQUFBLFVBQUEsU0FBQSxHQUNBLFFBQUEsS0FDQSxNQUFBLFFBQUEsYUFBQSxTQUFBLGdCQUFBLFVBRUEsTUFBQSxZQUVBLEdBQUEsR0FBQSxFQUNBLEVBQUEsRUFFQSxFQUFBLEVBQUEsZ0JBQ0EsU0FBQSxRQUFBLEdBQUEsS0FBQSxTQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsTUFBQSxXQUVBLEdBQUEsRUFDQSxFQUFBLElBQ0EsRUFBQSxTQUFBLGNBQ0EsRUFBQSxJQUNBLEVBQUEsU0FBQSxhQUNBLEVBQUEsWUFBQSxhQUNBLEVBQUEsS0FNQSxRQUFBLElBQUEsZ0JBQ0EsSUFDQSxFQUFBLElBQ0EsRUFBQSxZQUFBLGFBQ0EsRUFBQSxTQUFBLGlCQUNBLEVBQUEsRUFBQSxRQUFBLFNBQ0EsRUFBQSxTQUFBLGFBR0EsRUFBQSxZQUFBLGdCQUtBLEVBQUEsU0NsS0EsSUFBQSxVQUFBLHVCQUVBLFNBQUEsT0FBQSxlQUNBLFFBQUEsZUFBQSxRQUFBLEtBQUEsU0FBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLG1EQUFBLFNBQUEsWUFTQSxPQVBBLHNCQUFBLFNBQUEsRUFBQSxHQUNBLEdBQ0EsR0FBQSxFQUFBLE1BQUEsS0FDQSxFQUFBLEVBQUEsR0FBQSxLQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxVQUFBLEVBQUEsRUFDQSxPQUFBLEtBU0EsVUFBQSxXQUdBLEdBQUEsR0FBQSxFQUFBLFFBQ0EsSUE4Q0EsT0EzQ0EsR0FBQSxJQUFBLEdBQUEsUUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsS0FBQSxLQUtBLEdBQUEsT0FBQSxFQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsR0FBQSxNQUFBLEVBQUEsUUFBQSxHQUNBLE9BQUEsR0FBQSxZQUNBLFVBR0EsRUFBQSxLQUFBLEVBQUEsU0FBQSxHQUVBLFFBQUEsSUFBQSxFQUVBLElBQUEsS0FFQSxHQUFBLEdBQUEsRUFBQSxVQUFBLEdBQ0EsRUFBQSxNQUFBLEVBQUEsTUFBQSxHQUNBLEVBQUEsU0FBQSxFQUFBLFFBQUEsR0FDQSxFQUFBLFNBQUEsRUFBQSxLQUFBLEdBQUEsS0FHQSxtQkFBQSxFQUFBLE9BS0EsRUFBQSxJQUFBLEVBQUEsVUFBQSxRQUFBLFNBQUEsR0FFQSxFQUFBLE1BQUEscUJBQUEsRUFBQSxLQUFBLE1BQUEsR0FBQSxRQUFBLEtBQ0EsRUFBQSxLQUFBLEtBRUEsTUFBQSxTQUFBLEdBQ0EsUUFBQSxJQUFBLE9BR0EsRUFBQSxRQUFBLEtBRUEsTUFBQSxXQUNBLEVBQUEsU0FFQSxFQUFBLFNBR0EsY0FBQSxhQUdBLGVBQUEsU0FBQSxHQUVBLEdBQUEsTUFFQSxFQUFBLG1EQUFBLFNBQUEsWUFBQSxFQUFBLHdCQUNBLEVBQUEsRUFBQSxPQThDQSxPQTdDQSxHQUFBLElBQUEsR0FBQSxRQUFBLFNBQUEsR0FNQSxFQUFBLElBQUEsR0FBQSxRQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxLQUFBLEtBRUEsR0FBQSxLQUFBLEVBQUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxLQUFBLElBQ0EsRUFBQSxZQUFBLEVBQUEsUUFBQSxHQUNBLFFBQUEsSUFBQSxFQUFBLGdCQUtBLEVBQUEsTUFBQSxFQUFBLEtBQUEsTUFBQSxHQUNBLEVBQUEsU0FBQSxxQkFBQSxFQUFBLEtBQUEsTUFBQSxHQUFBLFFBQUEsSUFHQSxLQUFBLEdBRkEsTUFFQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEtBQUEsTUFBQSxPQUFBLElBQUEsQ0FFQSxHQUFBLEdBQUEsRUFBQSxLQUFBLE1BQUEsR0FFQSxFQUFBLEVBQUEsUUFBQSxJQUFBLE1BQUEsS0FFQSxFQUFBLEVBQUEsR0FBQSxLQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxrQkFBQSxFQUFBLEdBQ0EsRUFBQSxFQUFBLEdBQUEsS0FBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsVUFBQSxFQUFBLEVBQ0EsR0FBQSxJQUFBLEVBQ0EsRUFBQSxPQUFBLEVBRUEsRUFBQSxLQUFBLEdBR0EsRUFBQSxPQUFBLEVBRUEsRUFBQSxRQUFBLE9BS0EsTUFBQSxXQUNBLEVBQUEsU0FFQSxFQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICd1aS5yb3V0ZXInLFxuICAnbmdBbmltYXRlJyxcbiAgJ2FuZ3VsYXItY2Fyb3VzZWwnLFxuICAndGVtcGxhdGVzY2FjaGUnLFxuICAnbmdUZXh0VHJ1bmNhdGUnLFxuICAncHJvamVjdHMnXG5dKVxuLnJ1bihmdW5jdGlvbigpIHtcbiAgRmFzdENsaWNrLmF0dGFjaChkb2N1bWVudC5ib2R5KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ3Byb2plY3RzJywgW10pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvcHJvamVjdHMnKTtcbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ3Byb2plY3RMaXN0Jywge1xuICAgICAgdXJsICAgICAgICAgOiAnL3Byb2plY3RzJyxcbiAgICAgIGNvbnRyb2xsZXIgIDogJ1Byb2plY3RzQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybCA6ICdwcm9qZWN0cy9wcm9qZWN0cy5odG1sJ1xuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0RGV0YWlsJywge1xuICAgICAgdXJsICAgICAgICAgOiAnL3Byb2plY3RzLzppZCcsXG4gICAgICBjb250cm9sbGVyICA6ICdQcm9qZWN0Q3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybCA6ICdwcm9qZWN0cy9wcm9qZWN0Lmh0bWwnXG4gICAgfSlcbn0pXG4iLCIndXNlIHN0cmljdCdcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAuY29udHJvbGxlcignVmlld0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAkc2NvcGUubGF5b3V0Q29uZmlnID0ge1xuICAgICAgZnVsbEJsZWVkIDogJ2Z1bGxibGVlZCdcbiAgICB9XG4gIH0pXG4gIC5jb250cm9sbGVyKCdQcm9qZWN0c0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGZpbHRlciwgZGF0YVNlcnZpY2UpIHtcbiAgICAkc2NvcGUubGF5b3V0Q29uZmlnLmZ1bGxibGVlZCA9ICdmdWxsYmxlZWQnO1xuICAgIGRhdGFTZXJ2aWNlLmdldEFsYnVtcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRzY29wZS5wcm9qZWN0cyAgICAgICA9IGRhdGE7XG4gICAgICAkc2NvcGUucHJlZGljYXRlICAgICAgPSAnLW1vZGlmaWVkJztcbiAgICB9KTtcbiAgfSlcbiAgLmNvbnRyb2xsZXIoJ1Byb2plY3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGVQYXJhbXMsIGRhdGFTZXJ2aWNlKSB7XG4gICAgLy8gY29uc29sZS5sb2coJHN0YXRlUGFyYW1zLmlkKTtcbiAgICBcbiAgICAkc2NvcGUubGF5b3V0Q29uZmlnLmZ1bGxibGVlZCA9ICcnO1xuICAgIFxuICAgICRzY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGV2ZW50LCB0b1N0YXRlKTtcbiAgICB9KTtcblxuICAgIGRhdGFTZXJ2aWNlLmdldEFsYnVtUGhvdG9zKCRzdGF0ZVBhcmFtcy5pZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAkc2NvcGUuY3VycmVudEFydHdvcmsgPSA2O1xuICAgICAgJHNjb3BlLnRpdGxlICAgICAgICAgID0gZGF0YS50aXRsZTtcbiAgICAgICRzY29wZS5kZXNjcmlwdGlvbiAgICA9IGRhdGEuZGVzY3JpcHRpb247XG4gICAgICAkc2NvcGUubWFzdGhlYWQgICAgICAgPSBkYXRhLm1hc3RoZWFkO1xuICAgICAgJHNjb3BlLnBob3RvcyAgICAgICAgID0gZGF0YS5waG90b3M7XG4gICAgICAkc2NvcGUuY291bnQgICAgICAgICAgPSBkYXRhLnBob3Rvcy5sZW5ndGg7XG4gICAgfSk7XG4gICAgXG4gICAgJHNjb3BlLnVwZGF0ZUxpZ2h0Ym94ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgIGNvbnNvbGUubG9nKHR5cGVvZihpbmRleCkpO1xuICAgICAgJHNjb3BlLmN1cnJlbnRBcnR3b3JrID0gcGFyc2VJbnQoaW5kZXgpO1xuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgLmRpcmVjdGl2ZSgnbGlnaHRib3hUcmlnZ2VyJywgWyckdGltZW91dCcsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICByZXR1cm4ge1xuICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZihzY29wZS5jdXJyZW50QXJ0d29yayAhPT0gYXR0cnMuY3VycmVudEluZGV4KSB7XG4gICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZUxpZ2h0Ym94KGF0dHJzLmN1cnJlbnRJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBzY29wZS5jdXJyZW50QXJ0d29yayA9IGF0dHJzLmN1cnJlbnRJbmRleDtcbiAgICAgICAgICAgICQoJy5saWdodGJveCcpLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfV0pXG4gIC5kaXJlY3RpdmUoJ2NvbnRhY3RUb2dnbGUnLCBmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJCgnI2FwcCcpLmFkZENsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAkKCcjY29udGFjdCcpLmFkZENsYXNzKCdpcy12aXNpYmxlJyk7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICB9KVxuICAuZGlyZWN0aXZlKCdjbG9zZUFib3V0JywgZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHJldHVybiB7XG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgZWxlbWVudC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICQoJyNhcHAnKS5yZW1vdmVDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgJCgnI2NvbnRhY3QnKS5yZW1vdmVDbGFzcygnaXMtdmlzaWJsZScpO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgLmRpcmVjdGl2ZSgnbWFzdGhlYWQnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3BlIDoge1xuICAgICAgICBiYXIgOiAnPXVybCdcbiAgICAgIH0sXG4gICAgICBsaW5rIDogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgLypcbiAgICAgICAgICogIEJhc2ljYWxseSwgd2UncmUgbG9va2luZyB0byBzZWUgd2hlbiB0aGUgbWFpblxuICAgICAgICAgKiAgbWFzdGhlYWQgaW1hZ2UgbG9hZHMuIE9uY2UgaXQgZG9lcywgd2UgZmlyZSBvZmYgYVxuICAgICAgICAgKiAgc2VyaWVzIG9mIGFuaW1hdGlvbnMuXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgaGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpICsgJ3B4JztcbiAgICAgICAgXG4gICAgICAgIHNjb3BlLiR3YXRjaCgnYmFyJywgZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICAgIGlmKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICQoJzxpbWcvPicpLmF0dHIoJ3NyYycsIHZhbHVlKS5sb2FkKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOyAvLyBwcmV2ZW50IG1lbW9yeSBsZWFrc1xuICAgICAgICAgICAgICAvLyBBbmltYXRlIGNvbnRhaW5lciBhbmQgaW1hZ2VcbiAgICAgICAgICAgICAgLy8gLmlzLWxvYWRlZCBzZXRzIG9mIGFuaW1hdGlvbnMgZm9yIHRleHQgZWxlbWVudHNcbiAgICAgICAgICAgICAgLy8gdGhhdCBhcmUgY2hpbGRyZW4gb2YgLm1hc3RoZWFkXG4gICAgICAgICAgICAgIC8vIGVsZW1lbnQuY3NzKHsnaGVpZ2h0JyA6IGhlaWdodH0pO1xuICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdpcy1sb2FkZWQnKTtcbiAgICAgICAgICAgICAgLy8gQW5pbWF0ZSBhYnN0cmFjdCBpZiBpdCBleGlzdHNcbiAgICAgICAgICAgICAgJCgnLnByb2plY3QtYWJzdHJhY3QnKS5hZGRDbGFzcygnaXMtbG9hZGVkJyk7XG4gICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQoJy5tYXN0aGVhZCAubW9yZScpLmFkZENsYXNzKCdib3VuY2Utc2xvd2x5Jyk7XG4gICAgICAgICAgICAgIH0sIDM1MDApO1xuICAgICAgICAgICAgICAvLyBBbmltYXRlIGltYWdlIGdyaWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSlcbiAgLmRpcmVjdGl2ZSgnY2xvc2VMaWdodGJveCcsIFtmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHJldHVybiB7XG4gICAgICBsaW5rIDogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkKCcubGlnaHRib3gnKS5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNjb3BlLnVwZGF0ZUxpZ2h0Ym94KDApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XSlcbiAgLmRpcmVjdGl2ZSgncmlwcGxlJywgW2Z1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxpbmsgOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgXG4gICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZygndHJpZ2dlciByaXBwbGUnKTtcbiAgICAgICAgICBcbiAgICAgICAgICB2YXIgJGRpdiAgICAgID0gJCgnPGRpdi8+JyksXG4gICAgICAgICAgICAgIGJ0bk9mZnNldCA9ICQodGhpcykub2Zmc2V0KCksXG4gICAgICAgICAgICAgIHhQb3MgICAgICA9IGV2ZW50LnBhZ2VYIC0gYnRuT2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgIHlQb3MgICAgICA9IGV2ZW50LnBhZ2VZIC0gYnRuT2Zmc2V0LnRvcDtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgXG4gICAgICAgICAgICAkZGl2LmFkZENsYXNzKCdyaXBwbGUtZWZmZWN0Jyk7XG4gICAgICAgICAgICB2YXIgJHJpcHBsZSA9ICQoXCIucmlwcGxlLWVmZmVjdFwiKTtcbiAgICAgICAgICBcbiAgICAgICAgICAgICRyaXBwbGUuY3NzKFwiaGVpZ2h0XCIsICQodGhpcykuaGVpZ2h0KCkpO1xuICAgICAgICAgICAgJHJpcHBsZS5jc3MoXCJ3aWR0aFwiLCAkKHRoaXMpLmhlaWdodCgpKTtcbiAgICAgICAgICAgICRkaXYuY3NzKHtcbiAgICAgICAgICAgICAgdG9wOiB5UG9zIC0gKCRyaXBwbGUuaGVpZ2h0KCkvMiksXG4gICAgICAgICAgICAgIGxlZnQ6IHhQb3MgLSAoJHJpcHBsZS53aWR0aCgpLzIpLFxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAkKHRoaXMpLmRhdGEoXCJyaXBwbGUtY29sb3JcIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXBwZW5kVG8oJCh0aGlzKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAkZGl2LnJlbW92ZSgpO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgIH1cbiAgICB9O1xuICB9XSlcbiAgLmRpcmVjdGl2ZShcInNjcm9sbFwiLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRTY3JvbGwoKSB7XG4gICAgICByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgIFxuICAgICAgdmFyIHByZXZpb3VzU2Nyb2xsID0gMDtcbiAgICAgIHZhciBzY3JvbGxDb3VudGVyICA9IDA7XG4gICAgICBcbiAgICAgIHZhciAkaGVhZGVyID0gJCgnaGVhZGVyLmhlYWRlcicpO1xuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLmJpbmQoXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjdXJyZW50U2Nyb2xsID0gJCh0aGlzKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgXG4gICAgICAgIGlmKGN1cnJlbnRTY3JvbGwgPiBwcmV2aW91c1Njcm9sbCkge1xuICAgICAgICAgIGlmKGN1cnJlbnRTY3JvbGwgPiAwKSB7XG4gICAgICAgICAgICBpZighJGhlYWRlci5oYXNDbGFzcygnaXMtaGlkZGVuJykpIHtcbiAgICAgICAgICAgICAgaWYoc2Nyb2xsQ291bnRlciA+IDApIHtcbiAgICAgICAgICAgICAgICAkaGVhZGVyLmFkZENsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAkaGVhZGVyLnJlbW92ZUNsYXNzKCdpcy1maWxsZWQnKTtcbiAgICAgICAgICAgICAgICBzY3JvbGxDb3VudGVyID0gMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnc2Nyb2xsaW5nIHVwJyk7XG4gICAgICAgICAgc2Nyb2xsQ291bnRlcisrO1xuICAgICAgICAgIGlmKHNjcm9sbENvdW50ZXIgPiAyKSB7XG4gICAgICAgICAgICAkaGVhZGVyLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIGlmKCRoZWFkZXIuaGFzQ2xhc3MoJ3RyYW5zcGFyZW50JykpIHtcbiAgICAgICAgICAgICAgaWYoY3VycmVudFNjcm9sbCA+ICQod2luZG93KS5oZWlnaHQoKSkge1xuICAgICAgICAgICAgICAgICRoZWFkZXIuYWRkQ2xhc3MoJ2lzLWZpbGxlZCcpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICRoZWFkZXIucmVtb3ZlQ2xhc3MoJ2lzLWZpbGxlZCcpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHByZXZpb3VzU2Nyb2xsID0gZ2V0Q3VycmVudFNjcm9sbCgpO1xuICAgICAgfSk7XG4gICAgfTtcbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgR09PR0xFSUQgPSAnMTEyMjIzMjc2ODA1OTYyNzA1NTU1JztcblxuYW5ndWxhci5tb2R1bGUoJ3Byb2plY3RzJywgW10pXG4gIC5mYWN0b3J5KCdkYXRhU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuXG4gICAgdmFyIGFsYnVtc1VSTCA9ICdodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci8nICsgR09PR0xFSUQgKyAnLz9hbHQ9anNvbic7XG4gICAgXG4gICAgX2NyZWF0ZVBpYXNhUGhvdG9Vcmw9IGZ1bmN0aW9uKGlkLCBzaXplKSB7XG4gICAgICB2YXIgc2l6ZSA9IHNpemUgfHwgJ3MxMjgwJztcbiAgICAgIHZhciB0ZW1wVXJsID0gaWQuc3BsaXQoJy8nKTtcbiAgICAgIHZhciB1cmwgPSB0ZW1wVXJsWzBdICsgJy8vJyArIHRlbXBVcmxbMl0gKyAnLycgKyB0ZW1wVXJsWzNdICsgJy8nICsgdGVtcFVybFs0XSArICcvJyArIHRlbXBVcmxbNV0gKyAnLycgKyB0ZW1wVXJsWzZdICsgJy9zMTI4MC8nICsgdGVtcFVybFs3XTtcbiAgICAgIHJldHVybiB1cmxcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAvKlxuICAgICAgICogZ2V0QWxidW1zIGZldGNoZXMgYWxsIGFsYnVtcyBmcm9tIFBpY2FzYXdlYiBmb3IgYSBnaXZlblxuICAgICAgICogdXNlciBpZCBhbmQgcmV0dXJucyBhcyBhIGxpc3RcbiAgICAgICAqL1xuICAgICAgZ2V0QWxidW1zIDogZnVuY3Rpb24oKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgcHJvbWlzZVxuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgYWxidW1zID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBTZW5kIGluaXRpYWwgcmVxdWVzdFxuICAgICAgICAkaHR0cC5nZXQoYWxidW1zVVJMKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICB2YXIgcHJvamVjdHMgPSBkYXRhLmZlZWQuZW50cnk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQ3VycmVudGx5IHNvcnRpbmcgcHJvamVjdHMgYnkgbGFzdCB1cGRhdGVkXG4gICAgICAgICAgLy8gVGhpcyBpcyBhIGhhY2sgdW50aWwgd2UgY2FuIGZpZ3VyZSBvdXQgYSBtb3JlXG4gICAgICAgICAgLy8gZGV0ZXJtaW5pc3RpYyB3YXkgdG8gZXN0YWJsaXNoIHNvcnRpbmdcbiAgICAgICAgICBfLnNvcnRCeShwcm9qZWN0cywgZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShvYmoudXBkYXRlZC4kdCk7XG4gICAgICAgICAgICByZXR1cm4gZC5nZXRUaW1lKCk7XG4gICAgICAgICAgfSkucmV2ZXJzZSgpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE9yZ2FuaXplIGVhY2ggcHJvamVjdFxuICAgICAgICAgIF8uZWFjaChwcm9qZWN0cywgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFsYnVtID0ge307XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFsYnVtLmlkICAgICAgID0gZGF0YS5ncGhvdG8kaWQuJHQ7XG4gICAgICAgICAgICBhbGJ1bS50aXRsZSAgICA9IGRhdGEudGl0bGUuJHQ7XG4gICAgICAgICAgICBhbGJ1bS5tb2RpZmllZCA9IGRhdGEudXBkYXRlZC4kdDtcbiAgICAgICAgICAgIGFsYnVtLnRodW1iVXJsID0gZGF0YS5saW5rWzBdLmhyZWY7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERvbid0IHByb2Nlc3MgUHJvZmlsZSBQaG90b3MgYWxidW0sIHdoaWNoIGlzIGFsd2F5cyBwdWJsaWNcbiAgICAgICAgICAgIGlmKGFsYnVtLnRpdGxlID09PSAnUHJvZmlsZSBQaG90b3MnKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmV0Y2ggY292ZXIgaW1hZ2UgZm9yIHRoZSBhbGJ1bVxuICAgICAgICAgICAgJGh0dHAuZ2V0KGFsYnVtLnRodW1iVXJsKS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIC8vIGFsYnVtLnRodW1iID0gcmVzcG9uc2UuZmVlZC5lbnRyeVswXS5jb250ZW50LnNyYztcbiAgICAgICAgICAgICAgYWxidW0udGh1bWIgPSBfY3JlYXRlUGlhc2FQaG90b1VybChyZXNwb25zZS5mZWVkLmVudHJ5WzBdLmNvbnRlbnQuc3JjKTtcbiAgICAgICAgICAgICAgYWxidW1zLnB1c2goYWxidW0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShhbGJ1bXMpO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICB9LFxuICAgICAgXG4gICAgICBnZXRBbGJ1bVRodW1iIDogZnVuY3Rpb24oaWQpIHtcbiAgICAgIH0sXG5cbiAgICAgIGdldEFsYnVtUGhvdG9zIDogZnVuY3Rpb24oaWQpIHtcblxuICAgICAgICB2YXIgcHJvamVjdCA9IHt9O1xuXG4gICAgICAgIHZhciBhbGJ1bVVSTCA9ICdodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci8nICsgR09PR0xFSUQgKyAnL2FsYnVtaWQvJyArIGlkICsgJz9hbHQ9anNvbiY/aW1nbWF4PTkxMic7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICRodHRwLmdldChhbGJ1bVVSTCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQW1hemluZ2x5LCB3ZSBkb24ndCBnZXQgdGhlIGFsYnVtIHN1bW1hcnkgZnJvbSB0aGlzIEFQSS5cbiAgICAgICAgICAvLyBXZSBoYXZlIHRvIHJldHJpZXZlIGFsbCBhbGJ1bXMgaW4gb3JkZXIgdG8gZ2V0IHRoaXMgaW5mb1xuICAgICAgICAgIC8vIGFuZCB0aGVuIGNvbXBhcmUgdG8gdGhlIGN1cnJlbnQgaWRcblxuICAgICAgICAgICRodHRwLmdldChhbGJ1bXNVUkwpLnN1Y2Nlc3MoZnVuY3Rpb24oYWxidW1zKXtcbiAgICAgICAgICAgIHZhciBmZWVkID0gYWxidW1zLmZlZWQuZW50cnk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF8uZWFjaChmZWVkLCBmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgICAgICBpZihlbnRyeS5ncGhvdG8kaWQuJHQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgcHJvamVjdC5kZXNjcmlwdGlvbiA9IGVudHJ5LnN1bW1hcnkuJHQ7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdC5kZXNjcmlwdGlvbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBXaXRoIGFsYnVtIGRlc2NyaXB0aW9uLCBidWlsZCByZXN0IG9mIG9iamVjdFxuICAgICAgICAgICAgcHJvamVjdC50aXRsZSAgICA9IGRhdGEuZmVlZC50aXRsZS4kdDtcbiAgICAgICAgICAgIHByb2plY3QubWFzdGhlYWQgPSBfY3JlYXRlUGlhc2FQaG90b1VybChkYXRhLmZlZWQuZW50cnlbMF0uY29udGVudC5zcmMpO1xuICAgICAgICAgICAgdmFyIHBob3RvcyAgICAgICA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuZmVlZC5lbnRyeS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhLmZlZWQuZW50cnlbaV07XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICB2YXIgdGVtcFVybCA9IGl0ZW0uY29udGVudC5zcmMuc3BsaXQoJy8nKTtcblxuICAgICAgICAgICAgICB2YXIgdXJsID0gdGVtcFVybFswXSArICcvLycgKyB0ZW1wVXJsWzJdICsgJy8nICsgdGVtcFVybFszXSArICcvJyArIHRlbXBVcmxbNF0gKyAnLycgKyB0ZW1wVXJsWzVdICsgJy8nICsgdGVtcFVybFs2XSArICcvdzEyMDAtaDEyMDAtYy8nICsgdGVtcFVybFs3XTtcbiAgICAgICAgICAgICAgdmFyIGJpZ1VybCA9IHRlbXBVcmxbMF0gKyAnLy8nICsgdGVtcFVybFsyXSArICcvJyArIHRlbXBVcmxbM10gKyAnLycgKyB0ZW1wVXJsWzRdICsgJy8nICsgdGVtcFVybFs1XSArICcvJyArIHRlbXBVcmxbNl0gKyAnL3MxNjQwLycgKyB0ZW1wVXJsWzddO1xuICAgICAgICAgICAgICBpdGVtLnVybCA9IHVybDtcbiAgICAgICAgICAgICAgaXRlbS5iaWdVcmwgPSBiaWdVcmw7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBwaG90b3MucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcHJvamVjdC5waG90b3MgPSBwaG90b3M7XG5cbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocHJvamVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gcmV0dXJuIHJlc3VsdC5kYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=